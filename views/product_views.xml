<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- 
        CAMBIO 1: Deshabilitar el filtro personalizado.
        Usamos herencia con prioridad alta para asegurarnos de que se aplique al final.
    -->
    <record id="hide_custom_filters_app.view_product_search_disable_filter" model="ir.ui.view">
        <field name="name">product.search.disable.custom.filter</field>
        <field name="model">product.product</field>
        <field name="inherit_id" ref="product.product_view_search_catalog"/>
        <field name="priority">99</field>
        <field name="arch" type="xml">
            <xpath expr="//search" position="attributes">
                <attribute name="disable_custom_filters">1</attribute>
            </xpath>
        </field>
    </record>

    <!-- 
        CAMBIO 2: Añadir el Search Panel.
        Usamos otra vista heredada para añadir el panel. Esto separa las lógicas.
    -->
    <record id="hide_custom_filters_app.view_product_search_add_searchpanel" model="ir.ui.view">
        <field name="name">product.search.add.searchpanel</field>
        <field name="model">product.product</field>
        <field name="inherit_id" ref="product.product_view_search_catalog"/>
        <field name="priority">100</field> <!-- Prioridad aún más alta para que se aplique después del cambio anterior -->
        <field name="arch" type="xml">
            <xpath expr="//search" position="inside">
                <searchpanel>
                    <field name="categ_id" string="Product Category" icon="fa-th-list" enable_counters="1"/>
                    <field name="product_template_attribute_value_ids" string="Attributes" icon="fa-th-list" enable_counters="1" select="multi"/>
                </searchpanel>
            </xpath>
        </field>
    </record>

</odoo>